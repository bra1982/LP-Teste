var calcular_frete=function(){var b=$("[name=cep]").val(),a=$("[name=produto_id]").val(),c=$(".produto .acoes-produto:visible [name=qtde-carrinho]").val()||1;c={cep:b,produto_id:a,quantidade:c};$.cookie("cep",b,{expires:7,path:"/"});$(".cep ul").empty().removeClass("hide").addClass("loading").slideDown();if(!a)return a=$("<li>").html('<span class="error">Antes de calcular o frete \u00e9 necess\u00e1rio escolher as op\u00e7\u00f5es do produto.</span>'),$(".cep ul").append(a),$(".cep ul").removeClass("loading"),
!1;$.getJSON(URL_PRODUTO_FRETE_CALCULAR,c,function(d){$(".cep ul").empty();if(d&&0<d.length)if("erro"!=d.estado){for(var f in d){var e=d[f];if(e.msg_erro&&"0"!=e.erro&&"carrinho/index"==document.location.pathname){var h='<div class="alert alert-block alert-danger">'+e.nome_codigo_servico.toUpperCase()+": "+e.msg_erro+"</div>";var g=$("<li>").append(h)}else e.name&&(g=$("<li>").html('<span class="valor cor-principal">R$ :valor</span> <span class="prazo">:prazo dia:plural_dia \u00fat:plural_util</span> <span class="nome cor-secundaria">:nome</span>'),
g.html(g.html().replace(":nome",e.name).replace(":valor",formatar_decimal_br(e.price)).replace(":prazo",e.deliveryTime).replace(":plural_dia",1==e.deliveryTime?"":"s").replace(":plural_util",1==e.deliveryTime?"il":"eis")));e.msgErro&&(h='<div class="aviso">'+e.msgErro+"</div>",g.append(h));$(".cep ul").append(g)}$(".cep ul").next(".aviso-disponibilidade").slideDown()}else g=$('<li class="alert alert-error">').html(d.erro),$(".cep ul").append(g);else g=b?$('<li class="text-align-center">').html("N\u00e3o foram encontradas formas de envio para o CEP informado."):
$('<li class="text-align-center">').html("Por favor informe um CEP."),$(".cep ul").append(g);$(".cep ul").removeClass("loading")},"json");return!1};
(function(b){b.ProdutoOpcoes=function(a,c){this.$el=b(c);this._init(a)};b.ProdutoOpcoes.defaults={atributos:".atributos",item_atributo:".atributo-item",item_acao:".acoes-produto",class_ativo:".active",class_indisponivel:"indisponivel"};b.ProdutoOpcoes.prototype={_init:function(a){this.options=b.extend(!0,{},b.ProdutoOpcoes.defaults,a);this.options.class_ativo_sem_ponto=this.options.class_ativo.replace(".","");if(!b(this.options.atributos).length)return!1;this.total_grades=0;this._verificar_total_grades();
this._bind_click_opcoes();this._marcar_variacoes_indisponiveis()},_verificar_total_grades:function(){this.total_grades=b(this.options.atributos).children().length},_deselecionar_opcoes_mesmo_nivel:function(a){b(a).parents("ul").children(this.options.class_ativo).removeClass(this.options.class_ativo_sem_ponto)},_selecionar_imagem_atributo:function(a){if(a=produto_grades_imagens[a])b.each(a,function(c,d){b(".miniaturas li a[data-imagem-id="+d+"]").click()}),b(".acoes-flutuante").length&&b(".produto .conteiner-imagem img").length&&
b(".acoes-flutuante .image img").attr("src",b(".produto .conteiner-imagem img").attr("src").replace("380x380","210x210"))},_selecionar_opcao:function(a){b(a).parents("li").addClass(this.options.class_ativo_sem_ponto);this._esconder_variacoes_inexistentes(a);1<this.total_grades&&this._marcar_variacoes_indisponiveis(a);"true"==b(a).attr("data-pode-ter-imagens")&&this._selecionar_imagem_atributo(b(a).attr("data-variacao-id"))},_marcar_variacoes_indisponiveis:function(a){var c=this.options.item_atributo,
d=this.options.class_indisponivel,f=this.options.atributos;if(1==this.total_grades)b(this.options.item_acao).each(function(){var k=b(this),m=parseInt(getdata(k,"variacao-id"),10);k.hasClass("indisponivel")&&b(c+"[data-variacao-id="+m+"]").addClass(d)});else if(2==this.total_grades){var e=parseInt(b(a).attr("data-variacao-id"),10),h=[];b(f+" > div:last-child").find("a").each(function(k,m){k=b(m);h.push(e+"-"+b(k).attr("data-variacao-id"))});for(a=0;a<h.length;a++){f=b(this.options.item_acao+'[data-variacao-id="'+
h[a]+'"]');var g=h[a];g=g.split("-")[1];g=b(c+"[data-variacao-id="+g+"]");f.length&&(f.hasClass("indisponivel")?g.addClass(d):g.removeClass(d))}}},_esconder_variacoes_inexistentes:function(a){var c=this.options.class_indisponivel,d=this.options.class_ativo.replace(".",""),f=parseInt(getdata(b(a),"grade-id"),10);a=parseInt(getdata(b(a),"variacao-id"),10);var e=grades.indexOf(f),h=[],g;for(g in variacoes){var k=variacoes[g];variacoes_ids=variacoes[g][Object.keys(k)[0]];if("object"==typeof variacoes_ids&&
variacoes_ids[e]==a)for(var m in variacoes_ids)variacao_id=variacoes_ids[m],-1==h.indexOf(variacao_id)&&h.push(variacao_id)}b(this.options.item_atributo).each(function(){var l=b(this),n=parseInt(getdata(l,"variacao-id"),10),p=parseInt(getdata(l,"grade-id"),10);-1==h.indexOf(n)&&p!=f?(l.addClass(c),l.find(".icon-remove").show(),l.parent("li").removeClass(d)):1<b(".atributos > div").length&&l.find(".icon-remove").hide()})},_esconder_acoes_produto:function(){b(".acoes-produto[data-produto-id]").hide();
b(".parcelas-produto[data-produto-id]").hide()},_mostrar_acao_produto:function(a){var c=!1,d;for(d in variacoes){var f=variacoes[d];var e=Object.keys(f)[0];if(JSON.stringify(f[e])==JSON.stringify(a)){c=!0;break}}c?(b(".acoes-produto[data-produto-id="+e+"]").show(),b("[name=produto_id]").val(e),b(".parcelas-produto[data-produto-id="+e+"]").show()):b(".parcelas-produto.padrao").show()},_verificar_selecao_opcoes:function(){var a=this,c=b(a.options.atributos+" "+a.options.class_ativo);if(c.length==a.total_grades){var d=
[];c.each(function(f,e){f=b(e).find(a.options.item_atributo);f=parseInt(getdata(f,"variacao-id"),10);d.push(f)});a._esconder_acoes_produto();a._mostrar_acao_produto(d)}},_bind_click_opcoes:function(){var a=this;b(a.options.item_atributo).click(function(){a._esconder_acoes_produto();b('.acoes-produto[data-variacao-id=""]').show();a._deselecionar_opcoes_mesmo_nivel(this);a._selecionar_opcao(this);a._verificar_selecao_opcoes()})}};b.fn.produto_opcoes=function(a){return new b.ProdutoOpcoes(a,this)}})(jQuery);
$(function(){$(".preco-produto").on("click","#produto-consulta-preco",function(a){a.preventDefault();var c=$(this),d="#consulta-"+c.data("id");$(d).load("/contato/sob-consulta",function(){$(d).slideDown();c.data("nome")?$("#consulte-produto_nome").val(c.data("nome")):$("#consulte-produto_nome").val($(".produto .nome-produto").first().text());$("#consulte-produto_sku").val(c.data("sku"));$("#consulte-nome").focus()})});$("#formCalcularCep").submit(calcular_frete);CONTRATO_BRAZIL&&$("#formCalcularCep .input-cep").mask("00000-000",
{clearIfNotMatch:!0,onComplete:function(a){var c=$("#formCalcularCep .input-cep");c.data("cep_old")!=a&&9==a.length&&0>a.indexOf("_")&&(c.data("cep_old",a),$("#formCalcularCep").submit())}});$(".produto .atributos").produto_opcoes();imagem_grande&&($(".thumbs-horizontal #carouselImagem").flexslider({animation:"slide",direction:"horizontal",slideshow:!1,controlNav:!1,itemWidth:80,start:function(a){1===a.pagingCount&&a.addClass("flex-centered");$(".thumbs-horizontal #carouselImagem .flex-viewport").addClass("elastislide-carousel");
$(".thumbs-horizontal #carouselImagem li").removeClass("active flex-active-slide");$(".thumbs-horizontal #carouselImagem li:eq(0)").addClass("active");$("#imagemProduto").ImageZoom({bigImageSrc:imagem_grande})}}),$(".thumbs-vertical #carouselImagem").flexslider({animation:"slide",direction:"vertical",slideshow:!1,controlNav:!1,itemWidth:0,animationLoop:!1,maxItems:6,minItems:1,start:function(a){1===a.pagingCount&&a.addClass("flex-centered");1!==$(".thumbs-vertical .miniaturas li").length||$(".thumbs-vertical .produto-video").length||
($(".thumbs-vertical").hide(),$(".thumbs-vertical + .conteiner-imagem").css("margin-left",0));7>$(".thumbs-vertical .miniaturas li").length&&($(".thumbs-vertical .flex-direction-nav").hide(),$(".thumbs-vertical #carouselImagem").css("padding-bottom",5));$(".thumbs-vertical #carouselImagem .flex-viewport").addClass("elastislide-carousel");$(".thumbs-vertical #carouselImagem li").removeClass("active flex-active-slide");$(".thumbs-vertical #carouselImagem li:eq(0)").addClass("active");$(".thumbs-vertical #carouselImagem .flex-direction-nav .flex-nav-prev").prepend($('<div style="width: 30px; height: 30px; position: absolute; z-index: 11; bottom: 0; left: 0;"></div>'))},
before:function(a){a.animatingTo>=a.count-6?$(".thumbs-vertical #carouselImagem .flex-direction-nav .flex-nav-next").prepend($('<div style="width: 30px; height: 30px; position: absolute; z-index: 11; bottom: 0; right: 5px;"></div>')):$(".thumbs-vertical #carouselImagem .flex-direction-nav .flex-nav-next div").remove();0==a.animatingTo?$(".thumbs-vertical #carouselImagem .flex-direction-nav .flex-nav-prev").prepend($('<div style="width: 30px; height: 30px; position: absolute; z-index: 11; bottom: 0; left: 0;"></div>')):
$(".thumbs-vertical #carouselImagem .flex-direction-nav .flex-nav-prev div").remove()},after:function(a){a.animatingTo==a.count-6&&$(".thumbs-vertical #carouselImagem .flex-direction-nav .flex-nav-next a").addClass("flex-disabled")}}),$(".produto-thumbs").on("click",".miniaturas li a",function(a){a.preventDefault();$(this).parent().siblings().removeClass("active");$(this).parent().addClass("active");(a=$("#imagemProduto").data("imagezoom"))&&a.changeImage($(this).find("img").attr("data-mediumimg"),
$(this).find("img").attr("data-largeimg"))}));$("#abreZoom").click(function(){var a=[];var c=$("#abreZoom").attr("href");imagens_li=$(".produto .miniaturas li");for(i=0;i<imagens_li.length;i++)if($(imagens_li[i]).is(":visible")){var d=$("a",imagens_li[i]).attr("data-imagem-grande");a.push(d)}d=[{href:c}];for(i=0;i<a.length;i++){var f=a[i];f!=c&&d.push({href:f})}$.fancybox(d);return!1});$(".pagina-produto").on("click",".zm-viewer, .produto .conteiner-imagem img, .produto .conteiner-imagem > div",function(){$(".visible-phone").first().is(":visible")||
$("#abreZoom").click()});$(".miniaturas a").click(function(){var a=$(this).attr("data-imagem-grande");$("#abreZoom").attr("href",a)});$(".atributos .atributo-comum").each(function(a,c){10<$(c).find(".atributo-item").length&&transformarSelect(c)});$(".qtde-adicionar-carrinho").length&&(setTimeout(function(){$(window).resize(function(){$(".qtde-adicionar-carrinho").each(function(){$(this).width($(".principal .acoes-produto .botao.principal.botao-comprar:visible").outerWidth()-1)})}).resize()},500),
$(document).on("change keyup focusout",".qtde-adicionar-carrinho .qtde-carrinho",function(){var a=$(this).val(),c=$(this).parent().siblings(".botao-comprar");c.attr("href",c.attr("href").replace(/adicionar.*/g,"adicionar/"+a))}));if(-1<window.location.search.indexOf("sku=")){var b=/sku=([^&]+)/.exec(window.location.search)[1];(b=$(".produto .acoes-produto.SKU-"+b).first().data("variacao-id").toString().split("-"))&&$.each(b,function(a,c){$(".atributos ul li a[data-variacao-id="+c+"]").click()})}});
function transformarSelect(b){$(b).find("ul").addClass("dropdown").wrap("<div class='wrapper-dropdown componente'></div>");$(b).find(".wrapper-dropdown").prepend("<span>Selecione</span>");$(b).find(".wrapper-dropdown").on("click",function(){$(this).toggleClass("show")});$(b).find(".wrapper-dropdown .dropdown li a").on("click",function(){$(b).find(".wrapper-dropdown > span").text($(this).text())});if($(".atributos .atributo-cor").length)$(".atributos .atributo-cor li a").on("click",function(){$(b).find(".wrapper-dropdown > span").text("Selecione")})}
;
